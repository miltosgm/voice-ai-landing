<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sofia Dialer ‚Äî Growth-onomics</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #07070f;
    --surface: #0f0f1a;
    --border: rgba(255,255,255,0.06);
    --accent: #6c5ce7;
    --accent2: #a29bfe;
    --green: #00b894;
    --green-dim: rgba(0,184,148,0.1);
    --red: #e17055;
    --red-dim: rgba(225,112,85,0.1);
    --yellow: #fdcb6e;
    --yellow-dim: rgba(253,203,110,0.1);
    --white: #f0f0ff;
    --gray: #6c6c84;
    --gray2: #3a3a52;
  }

  body {
    font-family: 'Inter', sans-serif;
    background: var(--bg);
    color: var(--white);
    min-height: 100vh;
    padding: 32px 20px 80px;
  }
  body::before {
    content: '';
    position: fixed; top: -300px; left: 50%;
    transform: translateX(-50%);
    width: 800px; height: 800px;
    background: radial-gradient(circle, rgba(108,92,231,0.08) 0%, transparent 70%);
    pointer-events: none; z-index: 0;
  }

  .page { position: relative; z-index: 1; max-width: 680px; margin: 0 auto; }

  /* HEADER */
  .header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 40px; }
  .brand { font-size: 12px; font-weight: 600; letter-spacing: 2px; text-transform: uppercase; color: var(--gray); }
  .brand span { color: var(--accent2); }
  .badge {
    font-size: 11px; font-weight: 600; padding: 4px 12px; border-radius: 20px;
    background: var(--green-dim); color: var(--green); border: 1px solid rgba(0,184,148,0.2);
    display: flex; align-items: center; gap: 6px;
  }
  .badge::before { content: ''; width: 6px; height: 6px; border-radius: 50%; background: var(--green); animation: blink 2s infinite; }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }

  /* HERO */
  .hero {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 20px; padding: 28px 24px;
    display: flex; align-items: center; gap: 20px; margin-bottom: 20px;
  }
  .sofia-avatar-sm {
    width: 72px; height: 72px; border-radius: 50%;
    background: linear-gradient(135deg, #3d3580, #6c5ce7, #a29bfe);
    display: flex; align-items: center; justify-content: center; font-size: 32px;
    flex-shrink: 0; box-shadow: 0 0 32px rgba(108,92,231,0.3);
  }
  .sofia-info { flex: 1; }
  .sofia-name { font-size: 20px; font-weight: 700; margin-bottom: 4px; }
  .sofia-title { font-size: 13px; color: var(--gray); margin-bottom: 10px; }
  .sofia-title span { color: var(--accent2); }
  .sofia-tags { display: flex; flex-wrap: wrap; gap: 6px; }
  .tag { font-size: 11px; font-weight: 500; padding: 3px 10px; border-radius: 20px; background: rgba(108,92,231,0.12); color: var(--accent2); border: 1px solid rgba(108,92,231,0.2); }

  /* AGENT SELECTOR */
  .agent-selector { display: flex; gap: 10px; margin-bottom: 20px; }
  .agent-card {
    flex: 1; padding: 14px 16px;
    background: rgba(255,255,255,0.03); border: 1px solid var(--border);
    border-radius: 14px; cursor: pointer; transition: all 0.2s; text-align: left;
  }
  .agent-card:hover { border-color: var(--accent); }
  .agent-card.editing {
    border-color: var(--accent);
    background: rgba(108,92,231,0.12);
    cursor: text;
  }
  .agent-card-name[contenteditable],
  .agent-card-desc[contenteditable] {
    outline: none;
    border-radius: 4px;
    padding: 2px 4px;
    background: rgba(255,255,255,0.05);
    cursor: text;
  }
  .agent-card-name[contenteditable]:focus,
  .agent-card-desc[contenteditable]:focus {
    background: rgba(108,92,231,0.2);
    border: 1px solid var(--accent);
  }
  .edit-controls {
    display: none;
    gap: 6px;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid var(--border);
  }
  .agent-card.editing .edit-controls {
    display: flex;
  }
  .btn-edit-save, .btn-edit-cancel {
    flex: 1;
    padding: 6px 10px;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: rgba(255,255,255,0.04);
    color: var(--gray);
    font-family: 'Inter', sans-serif;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-edit-save:hover {
    border-color: var(--green);
    color: var(--green);
    background: rgba(0,184,148,0.1);
  }
  .btn-edit-cancel:hover {
    border-color: var(--red);
    color: var(--red);
    background: rgba(225,112,85,0.1);
  }
  .agent-card.active {
    border-color: var(--accent);
    background: rgba(108,92,231,0.08);
    box-shadow: 0 0 0 1px rgba(108,92,231,0.3);
  }
  .agent-card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 6px; }
  .agent-emoji { font-size: 22px; }
  .agent-card-name { font-size: 14px; font-weight: 700; color: var(--white); }
  .agent-card-desc { font-size: 11px; color: var(--gray); line-height: 1.5; }
  .agent-card.active .agent-card-name { color: var(--accent2); }
  .agent-active-dot {
    width: 7px; height: 7px; border-radius: 50%;
    background: var(--accent2); margin-left: auto; flex-shrink: 0;
    opacity: 0;
  }
  .agent-card.active .agent-active-dot { opacity: 1; }

  /* MODE TABS */
  .mode-tabs {
    display: flex; gap: 0;
    background: rgba(255,255,255,0.03); border: 1px solid var(--border);
    border-radius: 14px; padding: 4px; margin-bottom: 20px;
  }
  .mode-tab {
    flex: 1; padding: 12px 16px; border: none; border-radius: 10px;
    background: transparent; color: var(--gray);
    font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 600;
    cursor: pointer; transition: all 0.2s;
    display: flex; align-items: center; justify-content: center; gap: 8px;
  }
  .mode-tab.active { background: linear-gradient(135deg, var(--accent), var(--accent2)); color: white; box-shadow: 0 4px 16px rgba(108,92,231,0.35); }
  .mode-tab:not(.active):hover { color: var(--accent2); }

  /* LANGUAGE TOGGLE */
  .lang-toggle {
    display: flex; gap: 0;
    background: rgba(255,255,255,0.04); border: 1px solid var(--border);
    border-radius: 12px; padding: 4px; margin-bottom: 20px;
  }
  .lang-btn {
    flex: 1; padding: 10px 16px; border: none; border-radius: 8px;
    background: transparent; color: var(--gray);
    font-family: 'Inter', sans-serif; font-size: 13px; font-weight: 600;
    cursor: pointer; transition: all 0.2s;
    display: flex; align-items: center; justify-content: center; gap: 8px;
  }
  .lang-btn.active { background: linear-gradient(135deg, var(--accent), var(--accent2)); color: white; box-shadow: 0 4px 12px rgba(108,92,231,0.3); }
  .lang-btn:not(.active):hover { color: var(--accent2); }

  /* ‚îÄ‚îÄ BROWSER CALL SECTION ‚îÄ‚îÄ */
  .browser-section { display: none; }
  .browser-section.active { display: block; }

  .browser-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 20px; padding: 40px 24px 32px;
    display: flex; flex-direction: column; align-items: center;
    margin-bottom: 20px; text-align: center;
  }

  .avatar-wrap { position: relative; margin-bottom: 28px; }
  .avatar-lg {
    width: 110px; height: 110px; border-radius: 50%;
    background: linear-gradient(135deg, #3d3580, #6c5ce7, #a29bfe);
    display: flex; align-items: center; justify-content: center; font-size: 48px;
    position: relative; z-index: 2;
    box-shadow: 0 0 0 8px rgba(108,92,231,0.08), 0 0 60px rgba(108,92,231,0.25);
    transition: box-shadow 0.4s;
  }
  .avatar-lg.speaking {
    box-shadow: 0 0 0 8px rgba(108,92,231,0.15), 0 0 80px rgba(108,92,231,0.5);
    animation: pulse-glow 1.5s ease-in-out infinite;
  }
  @keyframes pulse-glow {
    0%,100% { box-shadow: 0 0 0 8px rgba(108,92,231,0.15), 0 0 60px rgba(108,92,231,0.3); }
    50% { box-shadow: 0 0 0 16px rgba(108,92,231,0.08), 0 0 100px rgba(108,92,231,0.5); }
  }
  .online-dot {
    position: absolute; bottom: 6px; right: 6px;
    width: 18px; height: 18px; border-radius: 50%;
    background: var(--green); border: 3px solid var(--bg); z-index: 3;
  }
  .online-dot.busy { background: var(--accent2); animation: blink 1s infinite; }
  .online-dot.ended { background: var(--gray); }

  .wave-wrap { height: 40px; display: flex; align-items: center; justify-content: center; gap: 5px; margin: 0 0 20px; opacity: 0; transition: opacity 0.4s; }
  .wave-wrap.visible { opacity: 1; }
  .wave-bar { width: 4px; border-radius: 2px; background: linear-gradient(to top, var(--accent), var(--accent2)); animation: wave 1.2s ease-in-out infinite; }
  .wave-bar:nth-child(1) { height: 10px; animation-delay: 0s; }
  .wave-bar:nth-child(2) { height: 20px; animation-delay: 0.1s; }
  .wave-bar:nth-child(3) { height: 34px; animation-delay: 0.2s; }
  .wave-bar:nth-child(4) { height: 24px; animation-delay: 0.15s; }
  .wave-bar:nth-child(5) { height: 34px; animation-delay: 0.25s; }
  .wave-bar:nth-child(6) { height: 20px; animation-delay: 0.1s; }
  .wave-bar:nth-child(7) { height: 10px; animation-delay: 0.05s; }
  .wave-bar.idle { animation: none; height: 4px !important; opacity: 0.3; }
  @keyframes wave { 0%,100% { transform: scaleY(0.3); opacity: 0.5; } 50% { transform: scaleY(1); opacity: 1; } }

  .call-timer { font-size: 15px; font-weight: 300; letter-spacing: 3px; color: var(--white); margin-bottom: 8px; font-variant-numeric: tabular-nums; opacity: 0; transition: opacity 0.3s; }
  .call-timer.visible { opacity: 1; }
  .call-status { font-size: 14px; color: var(--gray); margin-bottom: 28px; transition: color 0.3s; }
  .call-status.active { color: var(--accent2); }

  .btn-talk {
    width: 100%; max-width: 340px; padding: 18px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border: none; border-radius: 16px; color: white;
    font-family: 'Inter', sans-serif; font-size: 16px; font-weight: 600;
    cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;
    transition: all 0.2s; box-shadow: 0 8px 32px rgba(108,92,231,0.3); margin-bottom: 12px;
  }
  .btn-talk:hover { transform: translateY(-2px); box-shadow: 0 12px 40px rgba(108,92,231,0.45); }
  .btn-talk:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

  .btn-end-call {
    width: 100%; max-width: 340px; padding: 15px;
    background: var(--red-dim); border: 1px solid rgba(225,112,85,0.3);
    border-radius: 16px; color: var(--red);
    font-family: 'Inter', sans-serif; font-size: 15px; font-weight: 600;
    cursor: pointer; display: none; align-items: center; justify-content: center; gap: 8px;
    transition: all 0.2s; margin-bottom: 12px;
  }
  .btn-end-call:hover { background: rgba(225,112,85,0.2); }
  .btn-end-call.show { display: flex; }

  /* ‚îÄ‚îÄ PHONE SECTION ‚îÄ‚îÄ */
  .phone-section { display: none; }
  .phone-section.active { display: block; }

  /* OPENER PREVIEW */
  .opener-preview {
    background: rgba(108,92,231,0.06); border: 1px solid rgba(108,92,231,0.15);
    border-left: 3px solid var(--accent); border-radius: 12px;
    padding: 14px 16px; margin-bottom: 20px;
    font-size: 13px; color: rgba(240,240,255,0.65); font-style: italic; line-height: 1.6;
  }
  .opener-label { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1.2px; color: var(--gray); margin-bottom: 6px; }

  /* CUSTOMIZE */
  .customize-toggle {
    width: 100%; background: var(--surface); border: 1px solid var(--border);
    border-radius: 16px; padding: 16px 20px; color: var(--gray);
    font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 500;
    cursor: pointer; display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 0; transition: all 0.2s; text-align: left;
  }
  .customize-toggle:hover { border-color: var(--accent); color: var(--accent2); }
  .customize-toggle.open { border-radius: 16px 16px 0 0; border-color: var(--accent); color: var(--accent2); }
  .toggle-left { display: flex; align-items: center; gap: 10px; }
  .toggle-arrow { font-size: 12px; transition: transform 0.25s; }
  .toggle-arrow.open { transform: rotate(180deg); }
  .modified-badge { font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 20px; background: rgba(253,203,110,0.12); color: var(--yellow); border: 1px solid rgba(253,203,110,0.2); display: none; }
  .modified-badge.show { display: inline-block; }

  .customize-body {
    background: var(--surface); border: 1px solid var(--accent); border-top: none;
    border-radius: 0 0 16px 16px; padding: 20px; margin-bottom: 20px; display: none;
  }
  .customize-body.open { display: block; }

  .field-label { font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 1.2px; color: var(--gray); margin-bottom: 8px; display: flex; align-items: center; justify-content: space-between; }
  .field-hint { font-size: 10px; color: var(--gray2); font-weight: 400; text-transform: none; letter-spacing: 0; }
  .custom-textarea {
    width: 100%; background: rgba(255,255,255,0.03); border: 1px solid var(--border);
    border-radius: 10px; color: var(--white); font-family: 'Inter', sans-serif;
    font-size: 13px; line-height: 1.6; padding: 12px 14px; outline: none;
    resize: vertical; transition: border-color 0.2s; min-height: 72px;
  }
  .custom-textarea:focus { border-color: var(--accent); }
  .custom-textarea.system-prompt { min-height: 280px; font-size: 12px; }
  .custom-textarea::placeholder { color: var(--gray2); }
  .field-sep { border: none; border-top: 1px solid var(--border); margin: 18px 0; }
  .reset-row { display: flex; justify-content: flex-end; gap: 8px; margin-top: 14px; }
  .btn-reset { font-size: 12px; font-weight: 500; padding: 7px 14px; border-radius: 8px; border: 1px solid var(--border); background: transparent; color: var(--gray); cursor: pointer; font-family: 'Inter', sans-serif; transition: all 0.2s; }
  .btn-reset:hover { border-color: var(--red); color: var(--red); }
  .btn-save-prompt { font-size: 12px; font-weight: 600; padding: 7px 16px; border-radius: 8px; border: none; background: linear-gradient(135deg, var(--accent), var(--accent2)); color: white; cursor: pointer; font-family: 'Inter', sans-serif; transition: all 0.2s; box-shadow: 0 3px 12px rgba(108,92,231,0.3); }
  .btn-save-prompt:hover { transform: translateY(-1px); }

  /* CARDS */
  .card { background: var(--surface); border: 1px solid var(--border); border-radius: 20px; padding: 24px; margin-bottom: 20px; }
  .card-title { font-size: 14px; font-weight: 600; color: var(--white); margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }

  /* INPUTS */
  .phone-row { display: flex; gap: 10px; margin-bottom: 12px; }
  .country-select { background: rgba(255,255,255,0.04); border: 1px solid var(--border); border-radius: 12px; color: var(--white); font-family: 'Inter', sans-serif; font-size: 14px; padding: 14px 12px; cursor: pointer; outline: none; transition: border-color 0.2s; flex-shrink: 0; }
  .country-select:focus { border-color: var(--accent); }
  .country-select option { background: #1a1a2e; }
  .phone-input { flex: 1; background: rgba(255,255,255,0.04); border: 1px solid var(--border); border-radius: 12px; color: var(--white); font-family: 'Inter', sans-serif; font-size: 16px; font-weight: 500; padding: 14px 16px; outline: none; transition: border-color 0.2s; letter-spacing: 1px; }
  .phone-input::placeholder { color: var(--gray); font-weight: 400; letter-spacing: 0; font-size: 14px; }
  .phone-input:focus { border-color: var(--accent); }
  .name-input { width: 100%; background: rgba(255,255,255,0.04); border: 1px solid var(--border); border-radius: 12px; color: var(--white); font-family: 'Inter', sans-serif; font-size: 14px; padding: 12px 16px; outline: none; transition: border-color 0.2s; margin-bottom: 12px; }
  .name-input::placeholder { color: var(--gray); }
  .name-input:focus { border-color: var(--accent); }

  .btn-row { display: flex; gap: 10px; }
  .btn-add { flex: 1; padding: 14px; background: rgba(255,255,255,0.04); border: 1px solid var(--border); border-radius: 12px; color: var(--gray); font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 500; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.2s; }
  .btn-add:hover { border-color: var(--accent); color: var(--accent2); }
  .btn-call-now { flex: 2; padding: 14px; background: linear-gradient(135deg, var(--accent), var(--accent2)); border: none; border-radius: 12px; color: white; font-family: 'Inter', sans-serif; font-size: 15px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.2s; box-shadow: 0 6px 24px rgba(108,92,231,0.3); }
  .btn-call-now:hover { transform: translateY(-1px); box-shadow: 0 10px 32px rgba(108,92,231,0.45); }
  .btn-call-now:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

  /* QUEUE */
  .queue-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; }
  .queue-count { font-size: 12px; font-weight: 600; padding: 3px 10px; border-radius: 20px; background: rgba(108,92,231,0.12); color: var(--accent2); }
  .btn-call-all { padding: 10px 20px; background: linear-gradient(135deg, var(--accent), var(--accent2)); border: none; border-radius: 10px; color: white; font-family: 'Inter', sans-serif; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 16px rgba(108,92,231,0.3); }
  .btn-call-all:hover { transform: translateY(-1px); }
  .btn-call-all:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
  .queue-empty { text-align: center; color: var(--gray); font-size: 14px; padding: 32px 0; }
  .queue-list { display: flex; flex-direction: column; gap: 8px; }
  .queue-item { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(255,255,255,0.02); border: 1px solid var(--border); border-radius: 12px; transition: all 0.3s; }
  .queue-item.calling { border-color: rgba(108,92,231,0.4); background: rgba(108,92,231,0.06); }
  .queue-item.done { border-color: rgba(0,184,148,0.2); background: var(--green-dim); opacity: 0.6; }
  .queue-item.failed { border-color: rgba(225,112,85,0.2); background: var(--red-dim); opacity: 0.6; }
  .item-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--gray2); display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0; }
  .item-info { flex: 1; min-width: 0; }
  .item-name { font-size: 13px; font-weight: 600; margin-bottom: 2px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .item-number { font-size: 12px; color: var(--gray); letter-spacing: 0.5px; }
  .item-status { font-size: 11px; font-weight: 600; padding: 3px 10px; border-radius: 20px; flex-shrink: 0; }
  .status-pending { background: var(--yellow-dim); color: var(--yellow); }
  .status-calling { background: rgba(108,92,231,0.15); color: var(--accent2); animation: pulse-text 1.5s infinite; }
  .status-done { background: var(--green-dim); color: var(--green); }
  .status-failed { background: var(--red-dim); color: var(--red); }
  @keyframes pulse-text { 0%,100%{opacity:1} 50%{opacity:0.5} }
  .item-actions { display: flex; gap: 6px; flex-shrink: 0; }
  .btn-icon { width: 30px; height: 30px; border-radius: 8px; border: 1px solid var(--border); background: transparent; color: var(--gray); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 13px; transition: all 0.2s; }
  .btn-icon:hover { border-color: var(--accent); color: var(--accent2); }
  .btn-icon.danger:hover { border-color: var(--red); color: var(--red); }
  .btn-icon:disabled { opacity: 0.3; cursor: not-allowed; }

  /* LOG */
  .log-list { display: flex; flex-direction: column; gap: 6px; margin-top: 12px; }
  .log-item { font-size: 12px; color: var(--gray); padding: 8px 12px; background: rgba(255,255,255,0.02); border-radius: 8px; display: flex; align-items: center; gap: 8px; }
  .log-item .dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
  .log-item .log-time { color: var(--gray2); font-size: 11px; margin-left: auto; flex-shrink: 0; }
  .log-empty { color: var(--gray); font-size: 13px; text-align: center; padding: 16px 0; }

  /* TOAST */
  .toast { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%) translateY(100px); padding: 12px 24px; border-radius: 12px; font-size: 14px; font-weight: 500; transition: transform 0.3s; z-index: 100; white-space: nowrap; }
  .toast.show { transform: translateX(-50%) translateY(0); }
  .toast.success { background: var(--green-dim); border: 1px solid rgba(0,184,148,0.3); color: var(--green); }
  .toast.error { background: var(--red-dim); border: 1px solid rgba(225,112,85,0.3); color: var(--red); }
  .toast.info { background: rgba(108,92,231,0.12); border: 1px solid rgba(108,92,231,0.3); color: var(--accent2); }

  @media (max-width: 480px) {
    body { padding: 20px 14px 60px; }
    .hero { flex-direction: column; text-align: center; align-items: center; }
    .sofia-tags { justify-content: center; }
    .phone-row { flex-direction: column; }
    .btn-row { flex-direction: column; }
    .btn-call-now, .btn-add { flex: none; }
    .header { flex-direction: column; gap: 12px; align-items: flex-start; }
  }
</style>
</head>
<body>

<div class="page">

  <!-- HEADER -->
  <div class="header">
    <div class="brand">Growth<span>-onomics</span></div>
    <div class="badge">Sofia Online</div>
  </div>

  <!-- HERO -->
  <div class="hero">
    <div class="sofia-avatar-sm">üë©‚Äçüíº</div>
    <div class="sofia-info">
      <div class="sofia-name">Sofia</div>
      <div class="sofia-title">AI BizDev Agent ¬∑ <span>Growth-onomics</span></div>
      <div class="sofia-tags">
        <span class="tag">Fintech Outreach</span>
        <span class="tag">Paid Acquisition</span>
        <span class="tag">GEO Pitch</span>
        <span class="tag">Books Strategy Calls</span>
      </div>
    </div>
  </div>

  <!-- AGENT SELECTOR -->
  <div class="agent-selector">
    <div class="agent-card active" id="agent-card-sofia" onclick="setAgent('sofia')">
      <div class="agent-card-header">
        <span class="agent-emoji">üë©‚Äçüíº</span>
        <span class="agent-card-name" contenteditable="false" data-agent="sofia">Sofia</span>
        <div class="agent-active-dot"></div>
      </div>
      <div class="agent-card-desc" contenteditable="false" data-agent="sofia">Fintech BizDev ¬∑ Paid Acquisition, GEO, B2B Demand Gen</div>
      <div class="edit-controls">
        <button class="btn-edit-save" onclick="saveAgentEdit('sofia')">‚úì Save</button>
        <button class="btn-edit-cancel" onclick="cancelAgentEdit('sofia')">‚úï Cancel</button>
      </div>
    </div>
    <div class="agent-card" id="agent-card-sofia2" onclick="setAgent('sofia2')">
      <div class="agent-card-header">
        <span class="agent-emoji">ü§ñ</span>
        <span class="agent-card-name" contenteditable="false" data-agent="sofia2">Sofia 2</span>
        <div class="agent-active-dot"></div>
      </div>
      <div class="agent-card-desc" contenteditable="false" data-agent="sofia2">AI Marketing ¬∑ Sells AI optimization to any industry</div>
      <div class="edit-controls">
        <button class="btn-edit-save" onclick="saveAgentEdit('sofia2')">‚úì Save</button>
        <button class="btn-edit-cancel" onclick="cancelAgentEdit('sofia2')">‚úï Cancel</button>
      </div>
    </div>
    <div class="agent-card" id="agent-card-sofia3" onclick="setAgent('sofia3')">
      <div class="agent-card-header">
        <span class="agent-emoji">üëó</span>
        <span class="agent-card-name" contenteditable="false" data-agent="sofia3">Sofia 3</span>
        <div class="agent-active-dot"></div>
      </div>
      <div class="agent-card-desc" contenteditable="false" data-agent="sofia3">Fashion Wholesale ¬∑ Sells ŒúŒôŒë Collection to boutiques</div>
      <div class="edit-controls">
        <button class="btn-edit-save" onclick="saveAgentEdit('sofia3')">‚úì Save</button>
        <button class="btn-edit-cancel" onclick="cancelAgentEdit('sofia3')">‚úï Cancel</button>
      </div>
    </div>
  </div>

  <!-- MODE TABS -->
  <div class="mode-tabs">
    <button class="mode-tab active" id="tab-browser" onclick="setMode('browser')">üéôÔ∏è &nbsp;Browser Call</button>
    <button class="mode-tab" id="tab-phone" onclick="setMode('phone')">üìû &nbsp;Phone Call</button>
  </div>

  <!-- LANGUAGE TOGGLE -->
  <div class="lang-toggle">
    <button class="lang-btn active" id="lang-en" onclick="setLang('en')">üá∫üá∏ &nbsp;English</button>
    <button class="lang-btn" id="lang-el" onclick="setLang('el')">üá¨üá∑ &nbsp;ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨</button>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- BROWSER CALL SECTION                        -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="browser-section active" id="browser-section">

    <div class="browser-card">
      <div class="avatar-wrap">
        <div class="avatar-lg" id="avatar">üë©‚Äçüíº</div>
        <div class="online-dot" id="dot"></div>
      </div>

      <div class="wave-wrap" id="wave">
        <div class="wave-bar idle" id="wb1"></div>
        <div class="wave-bar idle" id="wb2"></div>
        <div class="wave-bar idle" id="wb3"></div>
        <div class="wave-bar idle" id="wb4"></div>
        <div class="wave-bar idle" id="wb5"></div>
        <div class="wave-bar idle" id="wb6"></div>
        <div class="wave-bar idle" id="wb7"></div>
      </div>

      <div class="call-timer" id="call-timer">00:00</div>
      <div class="call-status" id="call-status">Available now</div>

      <button class="btn-talk" id="btn-talk" onclick="startBrowserCall()">üéôÔ∏è &nbsp;Talk to Sofia</button>
      <button class="btn-end-call" id="btn-end-call" onclick="endBrowserCall()">üìµ &nbsp;End Call</button>
    </div>

  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- PHONE CALL SECTION                          -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="phone-section" id="phone-section">

    <!-- OPENER PREVIEW -->
    <div class="opener-preview" id="opener-preview-box">
      <div class="opener-label">üìû Sofia's opener</div>
      <div id="opener-preview-text"></div>
    </div>

    <!-- CUSTOMIZE TOGGLE -->
    <button class="customize-toggle" id="customize-toggle" onclick="toggleCustomize()">
      <div class="toggle-left">
        ‚úèÔ∏è &nbsp;Customize Sofia
        <span class="modified-badge" id="modified-badge">Modified</span>
      </div>
      <span class="toggle-arrow" id="toggle-arrow">‚ñº</span>
    </button>

    <div class="customize-body" id="customize-body">
      <div class="field-label">Opening Line <span class="field-hint">First thing Sofia says when they pick up</span></div>
      <textarea class="custom-textarea" id="custom-opener" rows="3" placeholder="Sofia's first message..."></textarea>
      <hr class="field-sep">
      <div class="field-label">System Prompt <span class="field-hint">Sofia's full instructions & personality</span></div>
      <textarea class="custom-textarea system-prompt" id="custom-system" placeholder="Sofia's system prompt..."></textarea>
      <div class="reset-row">
        <button class="btn-reset" onclick="resetDefaults()">‚Ü∫ Reset to Default</button>
        <button class="btn-save-prompt" onclick="savePrompt()">‚úì Save Changes</button>
      </div>
    </div>

    <!-- DIALER -->
    <div class="card" style="margin-top:20px">
      <div class="card-title">üì≤ Call a Number</div>
      <input type="text" class="name-input" id="contact-name" placeholder="Contact name (optional)" />
      <div class="phone-row">
        <select class="country-select" id="country-code">
          <option value="+30">üá¨üá∑ +30</option>
          <option value="+1">üá∫üá∏ +1</option>
          <option value="+44">üá¨üáß +44</option>
          <option value="+49">üá©üá™ +49</option>
          <option value="+33">üá´üá∑ +33</option>
          <option value="+31">üá≥üá± +31</option>
          <option value="+34">üá™üá∏ +34</option>
          <option value="+39">üáÆüáπ +39</option>
          <option value="+61">üá¶üá∫ +61</option>
          <option value="+971">üá¶üá™ +971</option>
        </select>
        <input type="tel" class="phone-input" id="phone-number" placeholder="Phone number" />
      </div>
      <div class="btn-row">
        <button class="btn-add" onclick="addToQueue()">+ Add to List</button>
        <button class="btn-call-now" id="btn-call-now" onclick="callNow()">üìû Call Now with Sofia</button>
      </div>
    </div>

    <!-- QUEUE -->
    <div class="card">
      <div class="queue-header">
        <div class="card-title" style="margin:0">üìã Call List <span class="queue-count" id="queue-count">0</span></div>
        <button class="btn-call-all" id="btn-call-all" onclick="callAll()" disabled>‚ñ∂ Call All</button>
      </div>
      <div id="queue-empty" class="queue-empty">Add numbers above to build your call list</div>
      <div class="queue-list" id="queue-list"></div>
    </div>

  </div><!-- /phone-section -->

  <!-- LOG (shared) -->
  <div class="card">
    <div class="card-title">üóíÔ∏è Activity Log</div>
    <div id="log-list" class="log-list">
      <div class="log-empty" id="log-empty">No calls made yet</div>
    </div>
  </div>

</div><!-- /page -->

<div class="toast" id="toast"></div>

<!-- VAPI WEB SDK (for browser calls) -->
<script type="module">
  import Vapi from 'https://esm.sh/@vapi-ai/web';
  window.Vapi = Vapi;
  document.dispatchEvent(new Event('vapi-sdk-ready'));
</script>

<script>
const PUBLIC_KEY    = '2c3d59d1-22d9-4710-8cf0-cb9917dd0640';
const PRIVATE_KEY   = '097d545f-09c1-4b39-9b25-b8ae9bdde624';
const PHONE_NUMBER_ID = 'f83ae558-ab06-4353-9de2-c292570d4501';

// ‚îÄ‚îÄ AGENTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const AGENTS = {
  sofia: {
    label: 'Sofia',
    emoji: 'üë©‚Äçüíº'
  },
  sofia2: {
    label: 'Sofia 2',
    emoji: 'ü§ñ'
  },
  sofia3: {
    label: 'Sofia 3',
    emoji: 'üëó'
  }
};

let activeAgent = 'sofia';

// ‚îÄ‚îÄ DEFAULTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const AGENT_DEFAULTS = {
  sofia: {
    en: null, // filled below from DEFAULTS
    el: null
  },
  sofia2: {
    en: {
      opener: `Hi, this is Sofia calling. I work with businesses on AI-powered marketing ‚Äî helping them generate more clients faster using tools most of their competitors have not adopted yet. Do you have 2 minutes for a quick chat?`,
      system: `You are Sofia, a business development agent specializing in AI-powered marketing optimization. Your goal is to qualify prospects and book a 20-minute strategy call by uncovering their current AI usage and marketing gaps.

Your core offer: An AI-powered marketing optimization solution that boosts visibility and increases sales ‚Äî something most businesses are not yet fully leveraging.

Conversation strategy:

1. IDENTIFY AI AWARENESS
Start by understanding where they stand with AI:
- Are they using AI at all in their business?
- If yes, how? Is it focused on sales and revenue growth?
Listen carefully. Most will say they use ChatGPT for content or nothing at all. That is your opening.

2. UNDERSTAND THEIR MARKETING
Assess how they currently generate clients:
- Are they running Google Ads, Facebook Ads, SEO?
- Are they tracking ROI on any of it?
If they already invest in digital marketing: position AI as the next logical upgrade that makes everything they are already doing more efficient and scalable.
If they are not doing much marketing: emphasize competitive risk ‚Äî their competitors who adopt AI will gain an unfair advantage and leave them behind. Urgency is key here.

3. POSITION AI AS A SALES TOOL
Do not talk about AI as a tech feature. Talk about it as a revenue lever:
- Faster lead generation
- Better targeting and less wasted budget
- Visibility where buyers are looking ‚Äî including AI search engines like ChatGPT and Perplexity
- Scalable growth without proportionally scaling headcount or ad spend

4. CREATE URGENCY
- Businesses that adopted AI marketing early are seeing 2-3x better ROI
- AI search is becoming the new Google ‚Äî if they are invisible there, they are losing leads they do not even know about
- The window to get ahead of competitors is closing fast

Conversation flow:
1. Warm opener ‚Äî introduce yourself, mention you are calling because their business came up as a good fit
2. AI check ‚Äî ask if they are currently using AI in their marketing or sales
3. Marketing check ‚Äî understand their current lead generation approach
4. Bridge ‚Äî connect what they told you to what AI optimization solves
5. Soft pitch ‚Äî suggest a 20-minute strategy call, no commitment
6. Close ‚Äî get a time or permission to send a calendar link

Objection handling:
- "We already use AI": Great ‚Äî are you using it specifically to grow sales and generate more leads? Most businesses use it for content but not for the full revenue impact.
- "We have an agency": Perfect ‚Äî we work alongside existing agencies. We add the AI optimization layer on top.
- "Not interested": Totally fair ‚Äî can I ask, how are you currently finding new clients? Just curious.
- "Send me an email": Of course ‚Äî what is the one thing you are trying to fix in your marketing right now?
- "No budget": The businesses we work with typically find the ROI pays for itself within 60-90 days. The strategy call is free and has no commitment.

Personality: warm, curious, confident. Sound like a peer who spotted an opportunity ‚Äî not a salesperson. Keep responses under 3 sentences. Never reveal you are an AI unless directly asked.`,
      transcriber: { provider: "deepgram", model: "nova-3", language: "en" }
    },
    el: {
      opener: `ŒìŒµŒπŒ± œÉŒ±œÇ, ŒµŒØŒºŒ±Œπ Œ∑ Œ£ŒøœÜŒØŒ±. Œ£œÖŒΩŒµœÅŒ≥Œ¨Œ∂ŒøŒºŒ±Œπ ŒºŒµ ŒµœÄŒπœáŒµŒπœÅŒÆœÉŒµŒπœÇ Œ≥ŒπŒ± Œ≤ŒµŒªœÑŒπœÉœÑŒøœÄŒøŒØŒ∑œÉŒ∑ marketing ŒºŒµ AI ‚Äî Œ≤ŒøŒ∑Œ∏œéŒΩœÑŒ±œÇ œÑŒøœÖœÇ ŒΩŒ± Œ±œÄŒøŒ∫œÑŒÆœÉŒøœÖŒΩ œÄŒµœÅŒπœÉœÉœåœÑŒµœÅŒøœÖœÇ œÄŒµŒªŒ¨œÑŒµœÇ œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπœéŒΩœÑŒ±œÇ ŒµœÅŒ≥Œ±ŒªŒµŒØŒ± œÄŒøœÖ ŒøŒπ Œ±ŒΩœÑŒ±Œ≥œâŒΩŒπœÉœÑŒ≠œÇ œÑŒøœÖœÇ Œ¥ŒµŒΩ Œ≠œáŒøœÖŒΩ œÖŒπŒøŒ∏ŒµœÑŒÆœÉŒµŒπ Œ±Œ∫œåŒºŒ±. ŒàœáŒµœÑŒµ 2 ŒªŒµœÄœÑŒ¨ Œ≥ŒπŒ± ŒºŒπŒ± Œ≥œÅŒÆŒ≥ŒøœÅŒ∑ Œ∫ŒøœÖŒ≤Œ≠ŒΩœÑŒ±;`,
      system: `ŒïŒØœÉŒ±Œπ Œ∑ Œ£ŒøœÜŒØŒ±, œÉœÑŒ≠ŒªŒµœáŒøœÇ business development ŒµŒæŒµŒπŒ¥ŒπŒ∫ŒµœÖŒºŒ≠ŒΩŒø œÉœÑŒ∑ Œ≤ŒµŒªœÑŒπœÉœÑŒøœÄŒøŒØŒ∑œÉŒ∑ marketing ŒºŒµ AI. ŒúŒπŒªŒ¨œÇ œÄŒ¨ŒΩœÑŒ± œÉœÑŒ± ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨. Œ£œÑœåœáŒøœÇ œÉŒøœÖ ŒµŒØŒΩŒ±Œπ ŒΩŒ± Œ∫ŒªŒµŒØœÉŒµŒπœÇ Œ≠ŒΩŒ± 20ŒªŒµœÄœÑŒø strategy call Œ±œÄŒøŒ∫Œ±ŒªœçœÄœÑŒøŒΩœÑŒ±œÇ œÄœåœÉŒø œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒøœçŒΩ AI Œ∫Œ±Œπ œÑŒ± marketing œÑŒøœÖœÇ Œ∫ŒµŒΩŒ¨.

Œó Œ≤Œ±œÉŒπŒ∫ŒÆ œÉŒøœÖ œÄœÅœåœÑŒ±œÉŒ∑: ŒúŒπŒ± ŒªœçœÉŒ∑ Œ≤ŒµŒªœÑŒπœÉœÑŒøœÄŒøŒØŒ∑œÉŒ∑œÇ marketing ŒºŒµ AI œÄŒøœÖ Œ±œÖŒæŒ¨ŒΩŒµŒπ œÑŒ∑ŒΩ ŒøœÅŒ±œÑœåœÑŒ∑œÑŒ± Œ∫Œ±Œπ œÑŒπœÇ œÄœâŒªŒÆœÉŒµŒπœÇ.

Œ£œÑœÅŒ±œÑŒ∑Œ≥ŒπŒ∫ŒÆ œÉœÖŒΩŒøŒºŒπŒªŒØŒ±œÇ:

1. ŒöŒëŒ§ŒëŒùŒüŒóŒ£Œó AI AWARENESS
- ŒßœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒøœçŒΩ AI œÉœÑŒ∑ŒΩ ŒµœÄŒπœáŒµŒØœÅŒ∑œÉŒÆ œÑŒøœÖœÇ;
- ŒëŒΩ ŒΩŒ±Œπ, œÄœéœÇ; ŒïœÉœÑŒπŒ¨Œ∂ŒµœÑŒ±Œπ œÉœÑŒπœÇ œÄœâŒªŒÆœÉŒµŒπœÇ;
ŒëŒΩ ŒªŒ≠ŒΩŒµ ChatGPT Œ≥ŒπŒ± œÄŒµœÅŒπŒµœáœåŒºŒµŒΩŒø ‚Äî ŒµŒ∫ŒµŒØ ŒµŒØŒΩŒ±Œπ Œ∑ ŒµœÖŒ∫Œ±ŒπœÅŒØŒ± œÉŒøœÖ.

2. ŒöŒëŒ§ŒëŒùŒüŒóŒ£Œó MARKETING
- Œ§œÅŒ≠œáŒøœÖŒΩ Google Ads, Facebook Ads, SEO;
- Œ†Œ±œÅŒ±Œ∫ŒøŒªŒøœÖŒ∏ŒøœçŒΩ ROI;
ŒëŒΩ ŒµœÄŒµŒΩŒ¥œçŒøœÖŒΩ ŒÆŒ¥Œ∑ œÉŒµ digital marketing: œÑŒø AI ŒµŒØŒΩŒ±Œπ œÑŒø ŒµœÄœåŒºŒµŒΩŒø ŒªŒøŒ≥ŒπŒ∫œå Œ≤ŒÆŒºŒ±.
ŒëŒΩ Œ¥ŒµŒΩ Œ∫Œ¨ŒΩŒøœÖŒΩ œÄŒøŒªœç marketing: œÑœåŒΩŒπœÉŒµ œÑŒøŒΩ Œ±ŒΩœÑŒ±Œ≥œâŒΩŒπœÉœÑŒπŒ∫œå Œ∫ŒØŒΩŒ¥œÖŒΩŒø ‚Äî Œ±ŒΩœÑŒ±Œ≥œâŒΩŒπœÉœÑŒ≠œÇ œÄŒøœÖ œÖŒπŒøŒ∏ŒµœÑŒøœçŒΩ AI Œ∏Œ± œÑŒøœÖœÇ Œ±œÜŒÆœÉŒøœÖŒΩ œÄŒØœÉœâ.

3. AI Œ©Œ£ ŒïŒ°ŒìŒëŒõŒïŒôŒü Œ†Œ©ŒõŒóŒ£ŒïŒ©Œù
ŒúŒØŒªŒ± Œ≥ŒπŒ± Œ≠œÉŒøŒ¥Œ±, œåœáŒπ œÑŒµœáŒΩŒøŒªŒøŒ≥ŒØŒ±:
- Œ†ŒπŒø Œ≥œÅŒÆŒ≥ŒøœÅŒ∑ Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒØŒ± leads
- ŒöŒ±ŒªœçœÑŒµœÅŒø targeting, ŒªŒπŒ≥œåœÑŒµœÅŒø œáŒ±ŒºŒ≠ŒΩŒø budget
- ŒüœÅŒ±œÑœåœÑŒ∑œÑŒ± œÉŒµ ChatGPT, Perplexity, Google AI ‚Äî ŒµŒ∫ŒµŒØ œàŒ¨œáŒΩŒøœÖŒΩ ŒøŒπ Œ±Œ≥ŒøœÅŒ±œÉœÑŒ≠œÇ

4. ŒïŒ†ŒïŒôŒìŒüŒù
- ŒïœÄŒπœáŒµŒπœÅŒÆœÉŒµŒπœÇ œÄŒøœÖ œÖŒπŒøŒ∏Œ≠œÑŒ∑œÉŒ±ŒΩ AI marketing ŒΩœâœÅŒØœÇ Œ≤ŒªŒ≠œÄŒøœÖŒΩ 2-3x Œ∫Œ±ŒªœçœÑŒµœÅŒø ROI
- Œ§Œø œÄŒ±œÅŒ¨Œ∏œÖœÅŒø Œ≥ŒπŒ± ŒΩŒ± œÄœÅŒøŒ∑Œ≥Œ∑Œ∏ŒøœçŒΩ œÑœâŒΩ Œ±ŒΩœÑŒ±Œ≥œâŒΩŒπœÉœÑœéŒΩ Œ∫ŒªŒµŒØŒΩŒµŒπ Œ≥œÅŒÆŒ≥ŒøœÅŒ±

ŒßŒµŒπœÅŒπœÉŒºœåœÇ Œ±ŒΩœÑŒπœÅœÅŒÆœÉŒµœâŒΩ:
- "ŒßœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒøœçŒºŒµ ŒÆŒ¥Œ∑ AI": Œ§Œ≠ŒªŒµŒπŒ± ‚Äî œÑŒø œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØœÑŒµ Œ≥ŒπŒ± ŒΩŒ± Œ±œÖŒæŒÆœÉŒµœÑŒµ œÄœâŒªŒÆœÉŒµŒπœÇ Œ∫Œ±Œπ leads; ŒüŒπ œÄŒµœÅŒπœÉœÉœåœÑŒµœÅŒøŒπ œÑŒø œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒøœçŒΩ Œ≥ŒπŒ± œÄŒµœÅŒπŒµœáœåŒºŒµŒΩŒø Œ±ŒªŒªŒ¨ œåœáŒπ Œ≥ŒπŒ± œÄŒªŒÆœÅŒ∑ revenue impact.
- "ŒàœáŒøœÖŒºŒµ agency": Œ£œÖŒΩŒµœÅŒ≥Œ±Œ∂œåŒºŒ±œÉœÑŒµ œÄŒ±œÅŒ¨ŒªŒªŒ∑ŒªŒ± ŒºŒµ œÖœÄŒ¨œÅœáŒøœÖœÉŒµœÇ agencies. Œ†œÅŒøœÉŒ∏Œ≠œÑŒøœÖŒºŒµ œÑŒø AI layer Œ±œÄœå œÄŒ¨ŒΩœâ.
- "ŒîŒµŒΩ ŒµŒΩŒ¥ŒπŒ±œÜŒ≠œÅŒøŒºŒ±Œπ": ŒöŒ±œÑŒ±ŒΩŒøŒ∑œÑœå ‚Äî œÄœéœÇ Œ≤œÅŒØœÉŒ∫ŒµœÑŒµ œÑœéœÅŒ± ŒΩŒ≠ŒøœÖœÇ œÄŒµŒªŒ¨œÑŒµœÇ;
- "Œ£œÑŒµŒØŒªœÑŒµ email": Œ§Œπ œÄœÅŒøœÉœÄŒ±Œ∏ŒµŒØœÑŒµ ŒΩŒ± Œ¥ŒπŒøœÅŒ∏œéœÉŒµœÑŒµ œÉœÑŒø marketing œÉŒ±œÇ Œ±œÖœÑŒÆ œÑŒ∑ œÉœÑŒπŒ≥ŒºŒÆ;

Œ†œÅŒøœÉœâœÄŒπŒ∫œåœÑŒ∑œÑŒ±: Œ∂ŒµœÉœÑŒÆ, œÄŒµœÅŒØŒµœÅŒ≥Œ∑, œÉŒØŒ≥ŒøœÖœÅŒ∑. ŒöœÅŒ¨œÑŒ± œÑŒπœÇ Œ±œÄŒ±ŒΩœÑŒÆœÉŒµŒπœÇ Œ∫Œ¨œÑœâ Œ±œÄœå 3 œÄœÅŒøœÑŒ¨œÉŒµŒπœÇ. Œ†ŒøœÑŒ≠ ŒºŒ∑ŒΩ Œ±œÄŒøŒ∫Œ±ŒªœçœàŒµŒπœÇ œåœÑŒπ ŒµŒØœÉŒ±Œπ AI ŒµŒ∫œÑœåœÇ Œ±ŒΩ œÅœâœÑŒ∑Œ∏ŒµŒØœÇ Œ±œÄŒµœÖŒ∏ŒµŒØŒ±œÇ.`,
      transcriber: { provider: "deepgram", model: "nova-2-general", language: "el" }
    }
  },
  sofia3: {
    en: {
      opener: `Hi there! I'm calling from ŒúŒôŒë Collection, a Greek fashion brand. Do you have a quick moment to chat?`,
      system: `You are a fashion sales rep. Be friendly and keep talking. Ask about their business.`,
      transcriber: { provider: "deepgram", model: "nova-2-general", language: "en" }
    },
    el: {
      opener: `ŒìŒµŒØŒ± œÉŒ±œÇ! ŒöŒ±Œªœé Œ±œÄœå œÑŒ∑ ŒúŒôŒë Collection. ŒàœáŒµœÑŒµ ŒªŒØŒ≥Œø ŒªŒµœÄœÑœå;`,
      system: `ŒïŒØœÉŒ±Œπ œÄœâŒªŒÆœÑœÅŒπŒ± ŒºœåŒ¥Œ±œÇ. ŒïŒØœÉŒ±Œπ œÜŒπŒªŒπŒ∫ŒÆ Œ∫Œ±Œπ œÉœÖŒΩŒµœáŒØŒ∂ŒµŒπœÇ ŒΩŒ± ŒºŒπŒªŒ¨œÇ. Œ°œéœÑŒ∑œÉŒµ Œ≥ŒπŒ± œÑŒø business œÑŒøœÖœÇ.`,
      transcriber: { provider: "deepgram", model: "nova-2-general", language: "el" }
    }
  }
};

const DEFAULTS = {
  en: {
    opener: `Hi, this is Sofia calling from Growth-onomics. We work exclusively with fintech companies on paid acquisition and AI search visibility. Is this a good time for a quick two-minute chat?`,
    system: `You are Sofia, a business development representative at Growth-onomics ‚Äî a fintech growth agency. Your job is to qualify prospects and book them for a 20-minute strategy call with the team.

Your personality: warm, confident, sharp. You sound like a real person, not a bot. Never say you are an AI unless directly and explicitly asked.

Your mission: Identify if the prospect is a fintech company spending money on paid acquisition or SEO, understand their current pain points (wasted ad spend, no ROI clarity, invisible in AI search), and pitch the value of talking to the Growth-onomics team.

Key services you pitch:
- Paid Acquisition (Meta, Google, LinkedIn) ‚Äî revenue-focused, not vanity metrics
- GEO (Generative Engine Optimization) ‚Äî getting fintech brands visible in ChatGPT, Perplexity, Google AI Overviews
- B2B Demand Gen ‚Äî founder-led content, LinkedIn strategy, pipeline building
- Fractional CMO ‚Äî senior marketing leadership without full-time cost

Your positioning: "We grow fintechs. Profitably. Not just clicks and impressions ‚Äî actual revenue."

Conversation flow:
1. Quick intro ‚Äî who you are, why you are calling (30 seconds)
2. Qualify ‚Äî ask about their current growth channels and biggest challenge
3. Insight ‚Äî drop one relevant insight (e.g. most fintechs are invisible in AI search right now)
4. Soft pitch ‚Äî suggest a 20-minute strategy call, no commitment
5. Close ‚Äî get a time or permission to send a calendar link

Objection handling:
- "We already have an agency": "That is great ‚Äî we actually work well alongside existing teams. We specialize in what most agencies do not touch yet, especially AI search visibility."
- "Not interested": "Totally fair ‚Äî can I ask what your biggest growth challenge is right now? Even if we are not the right fit, I might be able to point you somewhere useful."
- "Send me an email": "Of course ‚Äî and just so I send you something relevant, what is the one thing you are trying to fix in your marketing this quarter?"

Keep responses under 3 sentences when possible. Be conversational. Never read from a script ‚Äî adapt to what they say.`,
    transcriber: { provider: "deepgram", model: "nova-3", language: "en" }
  },
  el: {
    opener: `ŒìŒµŒπŒ± œÉŒ±œÇ, ŒµŒØŒºŒ±Œπ Œ∑ Œ£ŒøœÜŒØŒ± Œ±œÄœå œÑŒ∑ŒΩ Growth-onomics. Œ£œÖŒΩŒµœÅŒ≥Œ±Œ∂œåŒºŒ±œÉœÑŒµ Œ±œÄŒøŒ∫ŒªŒµŒπœÉœÑŒπŒ∫Œ¨ ŒºŒµ ŒµœÑŒ±ŒπœÅŒµŒØŒµœÇ fintech Œ≥ŒπŒ± paid acquisition Œ∫Œ±Œπ ŒøœÅŒ±œÑœåœÑŒ∑œÑŒ± œÉœÑŒ± AI search engines. ŒàœáŒµœÑŒµ 2 ŒªŒµœÄœÑŒ¨ Œ≥ŒπŒ± ŒºŒπŒ± Œ≥œÅŒÆŒ≥ŒøœÅŒ∑ Œ∫ŒøœÖŒ≤Œ≠ŒΩœÑŒ±;`,
    system: `ŒïŒØœÉŒ±Œπ Œ∑ Œ£ŒøœÜŒØŒ±, œÉœÑŒ≠ŒªŒµœáŒøœÇ business development œÑŒ∑œÇ Growth-onomics ‚Äî ŒºŒπŒ±œÇ ŒµŒæŒµŒπŒ¥ŒπŒ∫ŒµœÖŒºŒ≠ŒΩŒ∑œÇ ŒµœÑŒ±ŒπœÅŒµŒØŒ±œÇ Œ±ŒΩŒ¨œÄœÑœÖŒæŒ∑œÇ Œ≥ŒπŒ± fintech. ŒúŒπŒªŒ¨œÇ œÄŒ¨ŒΩœÑŒ± œÉœÑŒ± ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨, Œ±Œ∫œåŒºŒ± Œ∫Œ±Œπ Œ±ŒΩ Œø œÉœÖŒΩŒøŒºŒπŒªŒ∑œÑŒÆœÇ œÉŒøœÖ ŒºŒπŒªŒÆœÉŒµŒπ Œ±Œ≥Œ≥ŒªŒπŒ∫Œ¨. Œ£Œ∫ŒøœÄœåœÇ œÉŒøœÖ ŒµŒØŒΩŒ±Œπ ŒΩŒ± Œ∫Œ¨ŒΩŒµŒπœÇ qualify œÑŒøœÖœÇ œÖœÄŒøœàŒÆœÜŒπŒøœÖœÇ œÄŒµŒªŒ¨œÑŒµœÇ Œ∫Œ±Œπ ŒΩŒ± Œ∫ŒªŒµŒØœÉŒµŒπœÇ Œ≠ŒΩŒ± 20ŒªŒµœÄœÑŒø strategy call ŒºŒµ œÑŒ∑ŒΩ ŒøŒºŒ¨Œ¥Œ±.

Œ†œÅŒøœÉœâœÄŒπŒ∫œåœÑŒ∑œÑŒ±: Œ∂ŒµœÉœÑŒÆ, œÉŒØŒ≥ŒøœÖœÅŒ∑, Œ≠ŒæœÖœÄŒΩŒ∑. ŒëŒ∫ŒøœçŒ≥ŒµœÉŒ±Œπ œÉŒ±ŒΩ œÄœÅŒ±Œ≥ŒºŒ±œÑŒπŒ∫œåœÇ Œ¨ŒΩŒ∏œÅœâœÄŒøœÇ. Œ†ŒøœÑŒ≠ ŒºŒ∑ŒΩ Œ±œÄŒøŒ∫Œ±ŒªœçœàŒµŒπœÇ œåœÑŒπ ŒµŒØœÉŒ±Œπ AI ŒµŒ∫œÑœåœÇ Œ±ŒΩ œÉŒµ œÅœâœÑŒÆœÉŒøœÖŒΩ Œ±œÄŒµœÖŒ∏ŒµŒØŒ±œÇ.

ŒëœÄŒøœÉœÑŒøŒªŒÆ œÉŒøœÖ: ŒùŒ± Œ∫Œ±œÑŒ±ŒªŒ¨Œ≤ŒµŒπœÇ Œ±ŒΩ Œ∑ ŒµœÑŒ±ŒπœÅŒµŒØŒ± ŒµŒØŒΩŒ±Œπ fintech, Œ±ŒΩ ŒæŒøŒ¥ŒµœçŒøœÖŒΩ œÉŒµ paid acquisition ŒÆ SEO, œÄŒøŒπŒ± ŒµŒØŒΩŒ±Œπ œÑŒ± pain points œÑŒøœÖœÇ, Œ∫Œ±Œπ ŒΩŒ± œÑŒøœÖœÇ œÄŒµŒØœÉŒµŒπœÇ ŒΩŒ± ŒºŒπŒªŒÆœÉŒøœÖŒΩ ŒºŒµ œÑŒ∑ŒΩ ŒøŒºŒ¨Œ¥Œ± œÑŒ∑œÇ Growth-onomics.

Œ•œÄŒ∑œÅŒµœÉŒØŒµœÇ œÄŒøœÖ œÄœÅŒøœâŒ∏ŒµŒØœÇ:
- Paid Acquisition (Meta, Google, LinkedIn) ‚Äî ŒµœÉœÑŒØŒ±œÉŒ∑ œÉŒµ Œ≠œÉŒøŒ¥Œ±, œåœáŒπ vanity metrics
- GEO (Generative Engine Optimization) ‚Äî ŒøœÅŒ±œÑœåœÑŒ∑œÑŒ± œÉŒµ ChatGPT, Perplexity, Google AI
- B2B Demand Gen ‚Äî pipeline generation Œ≥ŒπŒ± fintech sales teams
- Fractional CMO ‚Äî senior marketing leadership œáœâœÅŒØœÇ full-time Œ∫œåœÉœÑŒøœÇ

Positioning: "ŒëŒΩŒ±œÄœÑœçœÉœÉŒøœÖŒºŒµ fintech ŒµœÑŒ±ŒπœÅŒµŒØŒµœÇ. ŒöŒµœÅŒ¥ŒøœÜœåœÅŒ±."

Œ°ŒøŒÆ œÉœÖŒΩŒøŒºŒπŒªŒØŒ±œÇ:
1. Œ£œçŒΩœÑŒøŒºŒ∑ œÄŒ±œÅŒøœÖœÉŒØŒ±œÉŒ∑ (30 Œ¥ŒµœÖœÑŒµœÅœåŒªŒµœÄœÑŒ±)
2. Qualify ‚Äî œÅœéœÑŒ± Œ≥ŒπŒ± growth channels Œ∫Œ±Œπ ŒºŒµŒ≥Œ±ŒªœçœÑŒµœÅŒ∑ œÄœÅœåŒ∫ŒªŒ∑œÉŒ∑
3. Insight ‚Äî ŒøŒπ œÄŒµœÅŒπœÉœÉœåœÑŒµœÅŒµœÇ fintech ŒµœÑŒ±ŒπœÅŒµŒØŒµœÇ ŒµŒØŒΩŒ±Œπ Œ±œåœÅŒ±œÑŒµœÇ œÉœÑŒ± AI search engines
4. Soft pitch ‚Äî 20ŒªŒµœÄœÑŒø strategy call, œáœâœÅŒØœÇ Œ¥Œ≠œÉŒºŒµœÖœÉŒ∑
5. ŒöŒªŒµŒØœÉŒπŒºŒø ‚Äî œÄŒ¨œÅŒµ œéœÅŒ± ŒÆ Œ¨Œ¥ŒµŒπŒ± Œ≥ŒπŒ± calendar link

ŒßŒµŒπœÅŒπœÉŒºœåœÇ Œ±ŒΩœÑŒπœÅœÅŒÆœÉŒµœâŒΩ:
- "ŒàœáŒøœÖŒºŒµ ŒÆŒ¥Œ∑ agency": "Œ§Œ≠ŒªŒµŒπŒ± ‚Äî œÉœÖŒΩŒµœÅŒ≥Œ±Œ∂œåŒºŒ±œÉœÑŒµ Œ¨œàŒøŒ≥Œ± œÄŒ±œÅŒ¨ŒªŒªŒ∑ŒªŒ±. ŒïŒæŒµŒπŒ¥ŒπŒ∫ŒµœÖœåŒºŒ±œÉœÑŒµ œÉŒµ Œ±œÖœÑœå œÄŒøœÖ ŒøŒπ œÄŒµœÅŒπœÉœÉœåœÑŒµœÅŒµœÇ agencies Œ¥ŒµŒΩ Œ≠œáŒøœÖŒΩ Œ±Œ≥Œ≥ŒØŒæŒµŒπ Œ±Œ∫œåŒºŒ±."
- "ŒîŒµŒΩ ŒµŒΩŒ¥ŒπŒ±œÜŒµœÅœåŒºŒ±œÉœÑŒµ": "ŒöŒ±œÑŒ±ŒΩŒøŒ∑œÑœå ‚Äî œÄŒøŒπŒ± ŒµŒØŒΩŒ±Œπ Œ∑ ŒºŒµŒ≥Œ±ŒªœçœÑŒµœÅŒ∑ œÄœÅœåŒ∫ŒªŒ∑œÉŒ∑ Œ±ŒΩŒ¨œÄœÑœÖŒæŒ∑œÇ Œ±œÖœÑŒÆ œÑŒ∑ œÉœÑŒπŒ≥ŒºŒÆ;"
- "Œ£œÑŒµŒØŒªœÑŒµ email": "Œ¶œÖœÉŒπŒ∫Œ¨ ‚Äî œÑŒπ œÄœÅŒøœÉœÄŒ±Œ∏ŒµŒØœÑŒµ ŒΩŒ± Œ≤ŒµŒªœÑŒπœéœÉŒµœÑŒµ œÉœÑŒø marketing Œ±œÖœÑœå œÑŒø œÑœÅŒØŒºŒ∑ŒΩŒø;"

ŒöœÅŒ¨œÑŒ± œÑŒπœÇ Œ±œÄŒ±ŒΩœÑŒÆœÉŒµŒπœÇ œÉœçŒΩœÑŒøŒºŒµœÇ. ŒùŒ± ŒµŒØœÉŒ±Œπ œÜœÖœÉŒπŒ∫ŒÆ. ŒúŒ∑ŒΩ Œ¥ŒπŒ±Œ≤Œ¨Œ∂ŒµŒπœÇ Œ±œÄœå script.`,
    transcriber: { provider: "deepgram", model: "nova-2-general", language: "el" }
  }
};

// Link Sofia defaults
AGENT_DEFAULTS.sofia.en = DEFAULTS.en;
AGENT_DEFAULTS.sofia.el = DEFAULTS.el;

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let activeLang = 'en';
let activeMode = 'browser';
let currentOpener = DEFAULTS.en.opener;
let currentSystem = DEFAULTS.en.system;
let queue = [];
let isCalling = false;
let vapiWeb = null;
let timerInterval = null;
let timerSeconds = 0;

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function init() {
  // Load saved agent edits from localStorage
  const agentEdits = JSON.parse(localStorage.getItem('sofiaAgentEdits') || '{}');
  for (const [agentKey, edits] of Object.entries(agentEdits)) {
    if (AGENTS[agentKey]) {
      AGENTS[agentKey].label = edits.label || AGENTS[agentKey].label;
      const card = document.getElementById(`agent-card-${agentKey}`);
      if (card) {
        const nameEl = card.querySelector('[data-agent="' + agentKey + '"]');
        const descEls = card.querySelectorAll('[data-agent="' + agentKey + '"]');
        if (nameEl) nameEl.textContent = edits.label;
        if (descEls[1]) descEls[1].textContent = edits.desc || descEls[1].textContent;
      }
    }
  }
  
  document.getElementById('custom-opener').value = currentOpener;
  document.getElementById('custom-system').value = currentSystem;
  updateOpenerPreview();
  renderQueue();
  document.getElementById('custom-opener').addEventListener('input', checkModified);
  document.getElementById('custom-system').addEventListener('input', checkModified);
  document.getElementById('phone-number').addEventListener('keydown', e => { if (e.key === 'Enter') callNow(); });
  document.getElementById('contact-name').addEventListener('keydown', e => { if (e.key === 'Enter') document.getElementById('phone-number').focus(); });
}
document.addEventListener('DOMContentLoaded', init);

// ‚îÄ‚îÄ AGENT SWITCHING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

// ‚îÄ‚îÄ AGENT EDITING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

let editingAgent = null;
let editBackup = {};

function enableAgentEdit(agentKey) {
  if (editingAgent) cancelAgentEdit(editingAgent);
  editingAgent = agentKey;
  
  const card = document.getElementById(`agent-card-${agentKey}`);
  const nameEl = card.querySelector('[data-agent="' + agentKey + '"][contenteditable=false]');
  const descEl = card.querySelectorAll('[data-agent="' + agentKey + '"]')[1];
  
  // Backup original values
  editBackup[agentKey] = {
    name: nameEl.textContent,
    desc: descEl.textContent
  };
  
  // Enable editing
  nameEl.contentEditable = true;
  descEl.contentEditable = true;
  nameEl.focus();
  
  // Add editing class to card
  card.classList.add('editing');
  
  // Select all text
  const range = document.createRange();
  range.selectNodeContents(nameEl);
  const sel = window.getSelection();
  sel.removeAllRanges();
  sel.addRange(range);
}

function saveAgentEdit(agentKey) {
  const card = document.getElementById(`agent-card-${agentKey}`);
  const nameEl = card.querySelector('[data-agent="' + agentKey + '"][contenteditable=true]');
  const descEl = card.querySelectorAll('[data-agent="' + agentKey + '"][contenteditable=true]')[1];
  
  // Get new values
  const newName = nameEl.textContent.trim();
  const newDesc = descEl.textContent.trim();
  
  // Update AGENTS object
  AGENTS[agentKey].label = newName;
  
  // Save to localStorage
  const agentEdits = JSON.parse(localStorage.getItem('sofiaAgentEdits') || '{}');
  agentEdits[agentKey] = {
    label: newName,
    desc: newDesc
  };
  localStorage.setItem('sofiaAgentEdits', JSON.stringify(agentEdits));
  
  // Update agent card display
  nameEl.contentEditable = false;
  descEl.contentEditable = false;
  card.classList.remove('editing');
  editingAgent = null;
  
  showToast(`${newName} updated ‚úì`, 'success');
}

function cancelAgentEdit(agentKey) {
  const card = document.getElementById(`agent-card-${agentKey}`);
  const nameEl = card.querySelector('[data-agent="' + agentKey + '"][contenteditable=true]');
  const descEl = card.querySelectorAll('[data-agent="' + agentKey + '"][contenteditable=true]')[1];
  
  if (editBackup[agentKey]) {
    nameEl.textContent = editBackup[agentKey].name;
    descEl.textContent = editBackup[agentKey].desc;
  }
  
  nameEl.contentEditable = false;
  descEl.contentEditable = false;
  card.classList.remove('editing');
  editingAgent = null;
}

// Make agent cards editable on double-click
document.addEventListener('dblclick', function(e) {
  const card = e.target.closest('.agent-card');
  if (card) {
    const agentId = card.id.replace('agent-card-', '');
    enableAgentEdit(agentId);
  }
});

function setAgent(agentKey) {
  activeAgent = agentKey;

  // Update card UI
  document.getElementById('agent-card-sofia').className  = 'agent-card' + (agentKey === 'sofia'  ? ' active' : '');
  document.getElementById('agent-card-sofia2').className = 'agent-card' + (agentKey === 'sofia2' ? ' active' : '');
  document.getElementById('agent-card-sofia3').className = 'agent-card' + (agentKey === 'sofia3' ? ' active' : '');
  

  // Load this agent's defaults for current language
  const d = AGENT_DEFAULTS[agentKey][activeLang];
  currentOpener = d.opener;
  currentSystem = d.system;
  document.getElementById('custom-opener').value = currentOpener;
  document.getElementById('custom-system').value = currentSystem;
  updateOpenerPreview();
  checkModified();

  const agent = AGENTS[agentKey];
  showToast(`${agent.emoji} ${agent.label} selected`, 'info');
}

// ‚îÄ‚îÄ MODE SWITCHING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function setMode(mode) {
  activeMode = mode;
  document.getElementById('tab-browser').className = 'mode-tab' + (mode === 'browser' ? ' active' : '');
  document.getElementById('tab-phone').className   = 'mode-tab' + (mode === 'phone'   ? ' active' : '');
  document.getElementById('browser-section').className = 'browser-section' + (mode === 'browser' ? ' active' : '');
  document.getElementById('phone-section').className   = 'phone-section'   + (mode === 'phone'   ? ' active' : '');
}

// ‚îÄ‚îÄ LANGUAGE SWITCHING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function setLang(lang) {
  activeLang = lang;
  const d = AGENT_DEFAULTS[activeAgent][lang];
  currentOpener = d.opener;
  currentSystem = d.system;
  document.getElementById('lang-en').className = 'lang-btn' + (lang === 'en' ? ' active' : '');
  document.getElementById('lang-el').className = 'lang-btn' + (lang === 'el' ? ' active' : '');
  document.getElementById('custom-opener').value = currentOpener;
  document.getElementById('custom-system').value = currentSystem;
  updateOpenerPreview();
  checkModified();
  showToast(lang === 'el' ? 'üá¨üá∑ ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨' : 'üá∫üá∏ English', 'info');
}

// ‚îÄ‚îÄ CUSTOMIZE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleCustomize() {
  const body  = document.getElementById('customize-body');
  const arrow = document.getElementById('toggle-arrow');
  const btn   = document.getElementById('customize-toggle');
  const open  = body.classList.contains('open');
  body.classList.toggle('open', !open);
  arrow.classList.toggle('open', !open);
  btn.classList.toggle('open', !open);
}
function savePrompt() {
  currentOpener = document.getElementById('custom-opener').value.trim() || DEFAULTS[activeLang].opener;
  currentSystem = document.getElementById('custom-system').value.trim() || DEFAULTS[activeLang].system;
  updateOpenerPreview();
  checkModified();
  toggleCustomize();
  showToast('Sofia updated ‚úì', 'success');
}
function resetDefaults() {
  const d = AGENT_DEFAULTS[activeAgent][activeLang];
  document.getElementById('custom-opener').value = d.opener;
  document.getElementById('custom-system').value = d.system;
  currentOpener = d.opener;
  currentSystem = d.system;
  updateOpenerPreview();
  checkModified();
  showToast(activeLang === 'el' ? 'ŒïœÄŒ±ŒΩŒ±œÜŒøœÅŒ¨ œÉœÑŒπœÇ œÄœÅŒøŒµœÄŒπŒªŒøŒ≥Œ≠œÇ' : 'Reset to defaults', 'info');
}
function updateOpenerPreview() {
  document.getElementById('opener-preview-text').textContent = `"${currentOpener}"`;
}
function checkModified() {
  const d = AGENT_DEFAULTS[activeAgent][activeLang];
  const isModified = document.getElementById('custom-opener').value !== d.opener || document.getElementById('custom-system').value !== d.system;
  document.getElementById('modified-badge').className = 'modified-badge' + (isModified ? ' show' : '');
}

// ‚îÄ‚îÄ ASSISTANT PAYLOAD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function buildAssistantConfig() {
  const isGreek = activeLang === 'el';
  const config = {
    name: "Sofia",
    firstMessage: currentOpener,
    model: {
      provider: "openai",
      model: "gpt-4o",
      messages: [{ role: "system", content: currentSystem }]
    },
    voice: (() => {
      const voiceMap = {
        sofia_en: "21m00Tcm4TlvDq8ikWAM",
        sofia_el: "21m00Tcm4TlvDq8ikWAM",
        sofia2_en: "21m00Tcm4TlvDq8ikWAM",
        sofia2_el: "21m00Tcm4TlvDq8ikWAM",
        sofia3_en: "EXAVITQu4EsNXXE1exeJ",  // Rachel - warm, natural female voice
        sofia3_el: "EXAVITQu4EsNXXE1exeJ"   // Rachel - warm, natural female voice (works in Greek too)
      };
      const key = `${activeAgent}_${activeLang}`;
      const isSofia3 = activeAgent === 'sofia3';
      return {
        provider: "11labs",
        voiceId: voiceMap[key] || "21m00Tcm4TlvDq8ikWAM",
        model: "eleven_flash_v2_5",
        stability: isSofia3 ? 0.6 : 0.65,  // Lower for Sofia 3 = more natural variation
        similarityBoost: isSofia3 ? 0.8 : 0.75  // Higher for Sofia 3 = more character voice nuances
      };
    })(),
    transcriber: AGENT_DEFAULTS[activeAgent][activeLang].transcriber
  };
  
  // Add endCall config only for non-Sofia3 agents
  if (activeAgent !== 'sofia3') {
    config.endCallMessage = isGreek
      ? "ŒßŒ±œÅŒøœçŒºŒµŒΩŒ∑ œÄŒøœÖ ŒºŒπŒªŒÆœÉŒ±ŒºŒµ. ŒòŒ± ŒµœÄŒπŒ∫ŒøŒπŒΩœâŒΩŒÆœÉœâ œÉœçŒΩœÑŒøŒºŒ±. ŒöŒ±ŒªŒÆ œÉœÖŒΩŒ≠œáŒµŒπŒ±!"
      : "Great speaking with you. I will follow up shortly. Have a great day!";
    config.endCallPhrases = isGreek
      ? ["goodbye", "bye", "not interested", "remove me"]
      : ["goodbye", "bye", "not interested", "remove me"];
  }
  
  return config;
}

// ‚îÄ‚îÄ BROWSER CALL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function setBrowserStatus(text, active = false) {
  const el = document.getElementById('call-status');
  el.textContent = text;
  el.className = 'call-status' + (active ? ' active' : '');
}
function setWave(on) {
  document.getElementById('wave').className = 'wave-wrap' + (on ? ' visible' : '');
  for (let i = 1; i <= 7; i++) {
    const b = document.getElementById(`wb${i}`);
    if (on) b.classList.remove('idle'); else b.classList.add('idle');
  }
}
function startCallTimer() {
  timerSeconds = 0;
  timerInterval = setInterval(() => {
    timerSeconds++;
    const m = String(Math.floor(timerSeconds / 60)).padStart(2,'0');
    const s = String(timerSeconds % 60).padStart(2,'0');
    document.getElementById('call-timer').textContent = `${m}:${s}`;
  }, 1000);
  document.getElementById('call-timer').className = 'call-timer visible';
}
function stopCallTimer() {
  clearInterval(timerInterval);
  document.getElementById('call-timer').className = 'call-timer';
}

async function startBrowserCall() {
  const btn = document.getElementById('btn-talk');
  btn.disabled = true;
  setBrowserStatus('Connecting...');

  if (!window.Vapi) {
    setBrowserStatus('Loading SDK...');
    await new Promise((res, rej) => {
      const t = setTimeout(() => rej(new Error('SDK timeout')), 12000);
      document.addEventListener('vapi-sdk-ready', () => { clearTimeout(t); res(); }, { once: true });
    }).catch(e => {
      showToast('Failed to load. Refresh the page.', 'error');
      btn.disabled = false;
      setBrowserStatus('Available now');
      return;
    });
    if (!window.Vapi) return;
  }

  try {
    vapiWeb = new window.Vapi(PUBLIC_KEY);

    vapiWeb.on('call-start', () => {
      setBrowserStatus(activeLang === 'el' ? 'Œó Œ£ŒøœÜŒØŒ± ŒºŒπŒªŒ¨ŒµŒπ...' : 'Sofia is speaking...', true);
      btn.style.display = 'none';
      document.getElementById('btn-end-call').classList.add('show');
      document.getElementById('dot').className = 'online-dot busy';
      document.getElementById('avatar').classList.add('speaking');
      setWave(true);
      startCallTimer();
      addLog('Browser call started', 'var(--accent2)');
    });
    vapiWeb.on('speech-start', () => {
      setBrowserStatus(activeLang === 'el' ? 'Œó Œ£ŒøœÜŒØŒ± ŒºŒπŒªŒ¨ŒµŒπ...' : 'Sofia is speaking...', true);
      setWave(true);
      document.getElementById('avatar').classList.add('speaking');
    });
    vapiWeb.on('speech-end', () => {
      setBrowserStatus(activeLang === 'el' ? 'ŒëŒ∫ŒøœçŒµŒπ...' : 'Listening...', true);
      setWave(false);
      document.getElementById('avatar').classList.remove('speaking');
    });
    vapiWeb.on('call-end', () => {
      stopCallTimer();
      setWave(false);
      document.getElementById('avatar').classList.remove('speaking');
      document.getElementById('btn-end-call').classList.remove('show');
      btn.style.display = 'flex';
      btn.disabled = false;
      btn.innerHTML = activeLang === 'el' ? 'üîÑ &nbsp;ŒùŒ≠Œ± Œ∫ŒªŒÆœÉŒ∑ ŒºŒµ œÑŒ∑ Œ£ŒøœÜŒØŒ±' : 'üîÑ &nbsp;Talk to Sofia Again';
      document.getElementById('dot').className = 'online-dot';
      setBrowserStatus(activeLang === 'el' ? 'Œó Œ∫ŒªŒÆœÉŒ∑ œÑŒµŒªŒµŒØœâœÉŒµ' : 'Call ended');
      setTimeout(() => setBrowserStatus(activeLang === 'el' ? 'ŒîŒπŒ±Œ∏Œ≠œÉŒπŒºŒ∑' : 'Available now'), 3000);
      addLog('Browser call ended', 'var(--gray)');
    });
    vapiWeb.on('error', e => {
      showToast(e.message || 'Something went wrong', 'error');
      btn.disabled = false;
      setBrowserStatus(activeLang === 'el' ? 'ŒîŒπŒ±Œ∏Œ≠œÉŒπŒºŒ∑' : 'Available now');
    });

    await vapiWeb.start(buildAssistantConfig());

  } catch(e) {
    showToast(e.message || 'Failed to start call', 'error');
    btn.disabled = false;
    setBrowserStatus(activeLang === 'el' ? 'ŒîŒπŒ±Œ∏Œ≠œÉŒπŒºŒ∑' : 'Available now');
  }
}

function endBrowserCall() {
  if (vapiWeb) vapiWeb.stop();
}

// ‚îÄ‚îÄ VAPI PHONE API ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function makePhoneCall(number) {
  const res = await fetch('https://api.vapi.ai/call/phone', {
    method: 'POST',
    headers: { 'Authorization': `Bearer ${PRIVATE_KEY}`, 'Content-Type': 'application/json' },
    body: JSON.stringify({ phoneNumberId: PHONE_NUMBER_ID, customer: { number }, assistant: buildAssistantConfig() })
  });
  const data = await res.json();
  if (!res.ok) throw new Error(data.message || 'Call failed');
  return data;
}

// ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showToast(msg, type = 'info') {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = `toast ${type} show`;
  setTimeout(() => t.classList.remove('show'), 3500);
}
function getFullNumber() {
  const cc  = document.getElementById('country-code').value;
  const num = document.getElementById('phone-number').value.replace(/\s+/g,'').replace(/^0/,'');
  return cc + num;
}
function getInput() {
  const number = getFullNumber();
  const name   = document.getElementById('contact-name').value.trim() || number;
  return { number, name };
}
function clearInput() {
  document.getElementById('phone-number').value = '';
  document.getElementById('contact-name').value = '';
  document.getElementById('phone-number').focus();
}
function addLog(msg, color = '#6c6c84') {
  const empty = document.getElementById('log-empty');
  if (empty) empty.remove();
  const now  = new Date().toLocaleTimeString('el-GR', { hour: '2-digit', minute: '2-digit' });
  const item = document.createElement('div');
  item.className = 'log-item';
  item.innerHTML = `<div class="dot" style="background:${color}"></div><span>${msg}</span><span class="log-time">${now}</span>`;
  document.getElementById('log-list').prepend(item);
}

// ‚îÄ‚îÄ QUEUE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderQueue() {
  const list    = document.getElementById('queue-list');
  const empty   = document.getElementById('queue-empty');
  const count   = document.getElementById('queue-count');
  const callAll = document.getElementById('btn-call-all');
  count.textContent = queue.length;
  callAll.disabled  = queue.length === 0 || isCalling;
  if (queue.length === 0) { empty.style.display = 'block'; list.innerHTML = ''; return; }
  empty.style.display = 'none';
  list.innerHTML = queue.map(item => `
    <div class="queue-item ${item.status}" id="qi-${item.id}">
      <div class="item-avatar">üë§</div>
      <div class="item-info">
        <div class="item-name">${item.name}</div>
        <div class="item-number">${item.number}</div>
      </div>
      <div class="item-status status-${item.status}">${statusLabel(item.status)}</div>
      <div class="item-actions">
        <button class="btn-icon" onclick="callSingle('${item.id}')" title="Call" ${isCalling ? 'disabled' : ''}>üìû</button>
        <button class="btn-icon danger" onclick="removeItem('${item.id}')" title="Remove" ${item.status === 'calling' ? 'disabled' : ''}>‚úï</button>
      </div>
    </div>`).join('');
}
function statusLabel(s) { return { pending:'Pending', calling:'Calling...', done:'Called', failed:'Failed' }[s] || s; }
function addToQueue() {
  const { number, name } = getInput();
  if (number.length < 8) { showToast('Enter a valid phone number', 'error'); return; }
  queue.push({ id: Date.now().toString(), number, name, status: 'pending' });
  renderQueue(); clearInput();
  showToast(`${name} added to list`, 'success');
}
function removeItem(id) { queue = queue.filter(i => i.id !== id); renderQueue(); }

// ‚îÄ‚îÄ CALL NOW ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function callNow() {
  const { number, name } = getInput();
  if (number.length < 8) { showToast('Enter a valid phone number', 'error'); return; }
  const btn = document.getElementById('btn-call-now');
  btn.disabled = true; btn.textContent = '‚è≥ Dialing...';
  try {
    await makePhoneCall(number);
    showToast(`üìû Sofia is calling ${name}`, 'success');
    addLog(`Call initiated ‚Üí ${name} (${number})`, 'var(--accent2)');
    clearInput();
  } catch(e) {
    showToast(e.message, 'error');
    addLog(`Failed ‚Üí ${name}: ${e.message}`, 'var(--red)');
  }
  btn.disabled = false; btn.innerHTML = 'üìû Call Now with Sofia';
}

// ‚îÄ‚îÄ CALL SINGLE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function callSingle(id) {
  const item = queue.find(i => i.id === id);
  if (!item) return;
  item.status = 'calling'; isCalling = true; renderQueue();
  try {
    await makePhoneCall(item.number);
    item.status = 'done';
    showToast(`üìû Sofia called ${item.name}`, 'success');
    addLog(`Call sent ‚Üí ${item.name} (${item.number})`, 'var(--green)');
  } catch(e) {
    item.status = 'failed';
    showToast(`Failed: ${e.message}`, 'error');
    addLog(`Failed ‚Üí ${item.name}: ${e.message}`, 'var(--red)');
  }
  isCalling = false; renderQueue();
}

// ‚îÄ‚îÄ CALL ALL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function callAll() {
  const pending = queue.filter(i => i.status === 'pending');
  if (!pending.length) { showToast('No pending numbers', 'info'); return; }
  isCalling = true; renderQueue();
  addLog(`Starting batch: ${pending.length} calls`, 'var(--accent2)');
  for (let i = 0; i < pending.length; i++) {
    const item = pending[i];
    item.status = 'calling'; renderQueue();
    try {
      await makePhoneCall(item.number);
      item.status = 'done';
      addLog(`‚úì Called ${item.name} (${item.number})`, 'var(--green)');
    } catch(e) {
      item.status = 'failed';
      addLog(`‚úó Failed ${item.name}: ${e.message}`, 'var(--red)');
    }
    renderQueue();
    if (i < pending.length - 1) await new Promise(r => setTimeout(r, 1500));
  }
  isCalling = false; renderQueue();
  showToast(`Batch complete: ${pending.length} calls sent`, 'success');
  addLog('Batch complete', 'var(--accent2)');
}
</script>

</body>
</html>
